<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Syslog Forwarder</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
      :root {
        /* Dark theme defaults */
        --bg:#0a0a0a; --card:#141414; --muted:#8f8f8f; --text:#f5f5f5; --border:#232323;
        --accent:#7c4dff; --accent2:#00e5ff; --danger:#ff5252; --success:#30d158;
        --glow: 0 0 0 6px rgba(124,77,255,0.12);
        --surface-2:#0e0e0e; --input-bg:#0f0f0f; --chip:#101010;
      }
      .light {
        /* Light theme overrides */
        --bg:#f7f8fb; --card:#ffffff; --muted:#556070; --text:#0f172a; --border:#e5e7eb;
        --accent:#6d28d9; --accent2:#0891b2; --danger:#dc2626; --success:#16a34a;
        --glow: 0 0 0 6px rgba(109,40,217,0.12);
        --surface-2:#f1f5f9; --input-bg:#f8fafc; --chip:#f8fafc;
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin:0; background:var(--bg); color:var(--text);
        font-family:'Noto Sans', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      }
      a { color: var(--text); text-decoration: none; }
      header { padding: 16px 24px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
      .brand { font-weight:700; letter-spacing:.3px; }
      .status-pill {
        display:inline-flex; align-items:center; gap:8px; padding:6px 10px;
        border:1px solid var(--border); border-radius:999px; font-size:12px; color:var(--muted);
        backdrop-filter: blur(2px);
      }
      .dot { width:8px; height:8px; border-radius:50%; background:var(--muted); display:inline-block; transition: all .2s ease; }
      .dot.running { background:var(--success); box-shadow:0 0 0 4px rgba(48,209,88,.12); }
      nav { padding: 0 24px 12px; border-bottom:1px solid var(--border); }
      .tabs { display:flex; gap:12px; align-items:center; }
      .tab {
        padding:8px 12px; border:1px solid var(--border); border-radius:999px; font-weight:600; color:var(--muted);
        transition: all .2s ease;
      }
      .tab:hover { border-color:var(--accent); color:#d6ccff; box-shadow: 0 0 0 3px rgba(124,77,255,0.15) inset; }
      .tab.active { color:var(--bg); background:linear-gradient(90deg, var(--text), #d8d8ff); border-color:transparent; }
      main { padding:24px; max-width:1200px; margin:0 auto; }
      .card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:16px; box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset; }
      .controls { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
      button, .btn {
        background:transparent; color:var(--text); border:1px solid var(--border);
        border-radius:10px; padding:10px 12px; font-weight:600; cursor:pointer;
        transition: transform .05s ease, box-shadow .2s ease, background .2s ease, color .2s ease, border-color .2s ease;
      }
      button.primary {
        background: linear-gradient(90deg, var(--accent), var(--accent2));
        color:#001018; border-color:transparent; box-shadow: var(--glow);
      }
      button.secondary { opacity:.9; }
      button:hover, .btn:hover { transform: translateY(-1px); }
      button:active, .btn:active { transform: translateY(0); }
      button:disabled { opacity:.5; cursor:not-allowed; transform:none; box-shadow:none; }
      .btn { padding:8px 10px; }
      input, select, textarea {
        outline: none; transition: box-shadow .2s ease, border-color .2s ease, background .2s ease;
        background: var(--input-bg) !important; color: var(--text) !important; border:1px solid var(--border) !important; border-radius:8px !important;
      }
      input:focus, select:focus, textarea:focus {
        border-color: var(--accent); box-shadow: 0 0 0 4px rgba(124,77,255,0.12);
      }
      .hint { color:var(--muted); font-size:12px; }
      /* Themed overrides for code/mono boxes */
      #log { background: var(--surface-2) !important; color: var(--text) !important; border-color: var(--border) !important; }
      #out { background: var(--surface-2) !important; color: var(--text) !important; border-color: var(--border) !important; }
      #inboundBox { background: var(--surface-2) !important; color: var(--text) !important; border-color: var(--border) !important; }
      /* Upload jiggle animation */
      @keyframes jiggle {
        0%, 100% { transform: translateX(0); }
        15% { transform: translateX(-4px); }
        30% { transform: translateX(4px); }
        45% { transform: translateX(-3px); }
        60% { transform: translateX(3px); }
        75% { transform: translateX(-2px); }
        90% { transform: translateX(2px); }
      }
      .upload-box {
        border:1px dashed var(--border); border-radius:12px; padding:12px; display:grid; gap:8px;
        transition: border-color .2s ease, background .2s ease;
      }
      .upload-box:hover { border-color: var(--accent); background: rgba(124,77,255,0.06); }
      .upload-box.shake { animation: jiggle .45s ease; }
    </style>
  </head>
  <body>
    <header>
      <div class="brand">Syslog Forwarder</div>
      <div class="status-pill">
        <span id="statusDot" class="dot {{ 'running' if running else '' }}"></span>
        <span id="statusText">{{ 'Running' if running else 'Stopped' }}</span>
      </div>
      <div class="controls">
        <button id="themeToggle" class="btn" title="Toggle theme">ðŸŒ“ Theme</button>
      </div>
    </header>
    <nav>
      <div class="tabs">
        <a href="{{ url_for('syslog_page') }}" class="tab {{ 'active' if section=='syslog' else '' }}">Syslog</a>
        <a href="{{ url_for('rest_page') }}" class="tab {{ 'active' if section=='rest' else '' }}">REST API</a>
        <a href="{{ url_for('webhook_page') }}" class="tab {{ 'active' if section=='webhook' else '' }}">Webhook</a>
        <a href="{{ url_for('config_view') }}" class="tab {{ 'active' if section=='config' else '' }}">Config</a>
      </div>
    </nav>
    <main>
      {% block content %}{% endblock %}
    </main>
    <script>
      (function() {
        const key = 'theme';
        const root = document.documentElement;
        function apply(t){
          if (t === 'light') root.classList.add('light'); else root.classList.remove('light');
        }
        // initial
        const saved = localStorage.getItem(key);
        if (saved) apply(saved);
        else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) apply('light');
        const btn = document.getElementById('themeToggle');
        if (btn) {
          btn.addEventListener('click', () => {
            const nowLight = !root.classList.contains('light');
            apply(nowLight ? 'light' : 'dark');
            localStorage.setItem(key, nowLight ? 'light' : 'dark');
          });
        }
      })();
    </script>
  </body>
</html>
